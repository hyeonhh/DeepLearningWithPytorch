# Chapter 7 새와 비행기 구별하기 : 이미지 학습 
## 7.1 작은 이미지를 모아놓은 데이터셋
### 7.1.1 CIFAR-10 다운로드
### 7.1.2 데이터셋 클래스
- 파이토치의 Dataset : `__len__` 와  `__getitem__` 을 구현하기 위해 필요한 객체이다
- `__len__` : 데이터셋의 아이템 수를 반환
- `__getitem__` : 샘플과 레이블(정수 인덱스)로 이루어진 아이템을 반환


### 7.1.3 데이터 변환
- 이제 PIL 이미지를 파이토치 텐서로 변환할 단계이다.
- 왜 변환해야하지?
  - 딥러닝 모델이 이미지를 tensor 형태로만 처리할 수 있기 때문이다.
  - PIL : 파이썬에서 이미지를 다루는 라이브러리 pilow에서 사용하는 데이터 타입
      - [높이, 너비 , 채널] 구조(HWC)
      - 픽셀 값이 0 ~ 255 범위의 정수
  - tensor : Pytorch 모델은 입력 데이터를 반드시 텐서 형태로 받아야함
      - [채널, 높이, 너비] 구조(CHW)
      - 픽셀 값이 0 ~ 1 범위의 실수(float)로 변환됨
- 변환 과정에서 일어나는일
  - 차원 구조 변경:  HWC -> CHW
  - 값의 범위 변경 : 0 ~ 255 -> 0 ~ 1로 정규화됨
  - 데이터 타입 변경 : PIL 이미지 -> torch.Tensor
- `torch.ToTensor()`
  
### 7.1.4 데이터 정규화 
- 데이터셋 정규화로 각 채널이 평균값 0과 단위 표준 편차를 가지게 한다.
- 데이터 정규화가 필요한 이유 :
  - 교재 설명 :  " -1과 1 혹은 -2와 2 사이에서 선형인 활성 함수를 택하고 데이터를 같은 범위에서 평균을 가지게한다면 뉴런은 0이 아닌 기울기를 가지게 되므로 빨리 학습할 수 있기 때문이다. " 
    -  활성 함수의 선형 구간과 정규화
      -  많은 활성 함수들은 입력값이 0 근처일 때 기울기가 크고, 입력이 너무 크거나 작으면 기울기가 거의 0(포화구간)이 된다
      -  만약 데이터를 -1 ~ 1 또는 -2 ~ 2 처럼 활성함수의 선형(민감)구간에 오도록 정규화하면 뉴런의 출력이 입력 변화에 따라 잘 반응하고, gradient도 충분히 커서 학습이 빠르고 잘 된다.
    -  평균을 0에 맞추는 이유
      - 데이터를 평균 0, 범위 -1~1로 맞추면, 대부분의 입력이 활성 함수의 민감한 구간에 위치하게 된다.
      - 이 때 뉴런의 출력은 0이 아닌 기울기를 가지므로, 오차가 역전파될 때 파라미터가 효과적으로 업데이트된다.
    - 정규화하지 않으면?
      - 입력값이 너무 크거나 작으면, 활성 함수가 포화구간에 들어가서 기울기가 거의 0이 된다.
  - 교재 설명 : "각 채널을 정규화해 동일한 분산을 가지게 되면 채널 정보가 동일한 학습률로 경사 하강을 통해 섞이고 업데이트되는 것을 보장할 수 있다"
    - 각 채널의 값 분포가 다르면 학습할 때 어떤 채널은 빠르게, 어떤 채널은 느리게 업데이트될 수 있다.
    - 그래서 각 채널별로 정규화해주면 모든 채널이 비슷한 스케일로 맞춰진다.

## 7.2 새와 비행기를 구별하기 
  

















